<!DOCTYPE html>
<html lang="en" ng-app="TidalWavePage">
  <% include header %>
  
  <body ng-cloak>
    <% include variables %>

    <% include navbar %>
    
    <div class="main-row col-lg-12">
      <% include sidebar %>
      <div ng-controller="PageContentController">
        <div ng-show="page && history">
          <div class="col-xs-14 col-lg-10">
            <table class="table table-bordered table-responsive">
              <tr>
                <th>Version</th>
                <th>Date</th>
                <th>Editors</th>

                <th style="width: 10em;" ng-if="comparing">Compare With</th>
                <th ng-if="!comparing">Compare</th>

                <th>Restore</th>
              </tr>
              <tr ng-repeat="pageVersion in history">
                <td>{{pageVersion.version}}</td>
                <td>{{prettyDate(pageVersion.timestamp)}}</td>
                <td>{{pageVersion.editors}}</td>
                <td><input type="checkbox"></td>
                <td ng-if="!$last">
                  <a href="#"><span class="glyphicon glyphicon-repeat"></span></a>
                </td>
              </tr>
            </table>
          </div>
        </div>

        <div ng-show="searchContentResults && !history">
          <div class="col-md-10">
            <h2>Search Results for '{{query}}'</h2>
            <ol ng-show="searchContentResults.length<=10">
              <li ng-repeat="result in searchContentResults">
                <h4><a ng-href="/view/{{result.name}}">{{result.name}}</a></h4>
              </li>
              <hr ng-if="!$last" />
            </ol>
            <ul class="pagination" ng-show="searchContentResults.length>10">
              <li class="disabled" ng-show="activePage==0"><a href="#">&laquo;</a></li>
              <li ng-show="activePage!=0"><a href="#">&laquo;</a></li>
              <!--
              {{#eachPage searchContentResults activePage}}
              {{#if activePage}}
              <li class="active"><a href="#">{{page}}</a></li>
              {{else}}
              <li><a href="#">{{page}}</a></li>
              {{/if}}
              {{/eachPage}}
              {{#ifGreaterThan numPages activePage}}
              <li><a href="#">&raquo;</a></li>
              {{else}}
              <li class="disabled"><a href="#">&raquo;</a></li>
              {{/ifGreaterThan}}
              -->
            </ul>
          </div>
        </div>

        <div ng-show="!page && !searchContentResults">
          <div id="home-page-content" class="col-xs-14 col-lg-10">
            <div class="well well-lg">
              <div>Recent Changes</div>
              <div>
                <ul>
                  <li ng-repeat="change in recentChanges">
                    <span>
                    <a href="{{change.id}}">{{change.title}}</a> updated by
                    <span ng-repeat="editor in change.editors">
                      <a href="{{editor.id}}">{{editor.name}}<span ng-if="!$last">,</span></a>
                    </span>
                    (<a href="">view change</a>) {{change.time}}
                    </span>
                    <hr ng-if="!$last" />
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>

        <div ng-show="page && !searchContentResults && !history">
          <div ng-show="settingsActive" id="settings" class="col-xs-12 col-lg-12">
            <div class="col-md-12">
              <div class="well well-lg", style="padding-top:0px; padding-bottom:300px">
                <form class="form-horizontal" role="form" ng-submit="updateSettings()">
                  <div class="form-group col-md-6">
                    <h3>Details</h3>
                    <label for="inputTitle" class="col-md-2 control-label">Title</label>
                    <div class="col-md-10">
                      <input type="text" class="form-control" id="inputTitle" ng-model="newName">
                    </div>
                    <label for="inputParent" class="col-md-2 control-label">Parent</label>
                    <div class="col-md-10">
                      <select id="select-parent" class="demo-default" placeholder="Pick a parent...">
                      </select>
                    </div>
                  </div>
                  <div class="form-group col-md-6">
                    <h3>Permissions</h3>
                    <label for="userPermissionList" class="col-md-2 control-label">Users</label>
                    <div class="col-md-10">
                      <p class="form-control-static" ng-if="derivedUserPermissions.join(',').length>0">From Parent: {{derivedUserPermissions.join(',')}}</p>
                      <input type="text" class="demo-default" id="userPermissionList" ng-model="userPermissionList">
                    </div>
                    <label for="groupPermissionList" class="col-md-2 control-label">Groups</label>
                    <div class="col-md-10">
                      <p class="form-control-static" ng-if="derivedGroupPermissions.join(',').length>0">From Parent: {{derivedGroupPermissions.join(',')}}</p>
                      <input type="text" class="form-control" id="groupPermissionList" ng-model="groupPermissionList">
                    </div>
                  </div>
                  <div class="col-md-12">
                    <div class="col-md-2 col-md-offset-5">
                      <button class="btn btn-default" type="submit">Update</button>
                    </div>
                  </div>
                </form>
              </div>
            </div>
          </div>

          <div id="ancestry" ng-show="!editMode" class="col-lg-10">
            <ol class="breadcrumb">
              <li ng-repeat="ancestor in ancestry"><a href="" ng-click="changePage(ancestor.name);">{{ancestor.name}}</a></li>
              <li class="active">{{page.name}}</li>
            </ol>
          </div>

          <div id="editor" class="col-xs-7 col-lg-6" ng-show="editMode">Loading...</div>
          <div id="content" class="col-xs-7 col-lg-6">
            <div ng-show="version" class="alert alert-warning" style="text-align: center;">
              <strong>You are viewing an old version of this page.</strong><br />
              <a class="alert-link" href="#">View Current version</a>&nbsp;&nbsp;&nbsp;&bull;&nbsp;&nbsp;&nbsp;
              <a class="alert-link" href="#">Show Differences</a>&nbsp;&nbsp;&nbsp;&bull;&nbsp;&nbsp;&nbsp;
              <a class="alert-link" href="#">Restore this version</a>&nbsp;&nbsp;&nbsp;&bull;&nbsp;&nbsp;&nbsp;
              <a class="alert-link" href="#">View Page History</a>
              <ul class="pager" style="margin-top:5px;">
                <li class="disabled"><a href="#">&larr; Older</a></li>
                <li>Version {{version}}</li>
                <li><a href="#">Newer &rarr;</a></li>
              </ul>
            </div>
            <div id="content-markdown">
            </div>
          </div>
        </div>
      </div>
    </div>

    <% include footer %>
  </body>
</html>
